<!DOCTYPE html>
<html>
<body>
  <button onclick="startAuth()">启动授权</button>
  <script>
    function startAuth() {
      // 通过弹窗打开授权页（用户点击按钮触发）
      const authWindow = window.open(
        "https://wangyuxin9.github.io/auth.html?code=MOCK_CODE&state=123",
        "authWindow",
        "width=580,height=680"
      );

      // 监听回调消息
      window.addEventListener('message', (e) => {
        if (e.data.type === 'oauth_callback') {
          console.log("收到授权码:", e.data.code);
          // 这里可以发送 code 到你的后端
          fetch("/api/token?code=" + e.data.code);
        }
      });
    }
  </script>
</body>
</html>